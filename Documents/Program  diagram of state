@startuml

[*] --> Initialization : At lounch module


state Initialization {
  Init_GPIO_module --> Init_RFID_module : if GPIO was inited
  Init_GPIO_module --> Unmount : if GPIO was not inited

  Init_RFID_module --> Init_stream : if RFID module was inited
  Init_RFID_module --> Unmount : RED led if RFID module was not inited

  Init_stream --> Finish_of_initialize : if stram was created
  Init_stream --> Unmount  : RED led if thread was not inited
    
  Finish_of_initialize: Turn on GREEN led
  Finish_of_initialize --> Thread
}



state Unmount {
	RED_LED: Turn on red led
}
Unmount->[*]



state Thread{
	Thread: is Infinity loop for checking actions

	Logic_RFID: if value of ID != 0
	Logic_RFID: Check read ID on exist	
	Logic_RFID: ID set to 0 
	Logic_RFID --> Lock: if ID exist in memory
	
	Logic_Button --> Lock: if button for open pressed
	Logic_Button: Check state of button
	
	Lock: Lock should be set to reverse state
}


RFID: RFID device on spi bus

RFID-->RFID_module: Interrupt from RFID
RFID_module --> RFID: Read value from device
RFID_module --> Thread: Callback with read value

@enduml
