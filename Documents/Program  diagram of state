@startuml

[*] --> Initialization : At lounch module


state Initialization {
  Init_GPIO_module --> Init_RFID_module : if GPIO was inited
  Init_GPIO_module --> Unmount : if GPIO was not inited

  Init_RFID_module --> Init_stream : if RFID module was inited
  Init_RFID_module --> Unmount : -> RED_LED if RFID module was not inited

  Init_stream --> Stream : if stram was created
  Init_stream --> Unmount  : -> RED_LED if stream was not inited
}



state Unmount {
	RED_LED: Turn on red led for 30 sec
}
Unmount->[*]



state Stream{
	Stream: is Infinity loop for checking read  value

	Logic: if value of ID != 0
	Logic: Check read ID on exist
	Logic --> Lock: if ID exist in memory
	Logic: ID set to 0 
}

state Lock{
	Lock: Lock should be set to reverse state
	Lock --> Stream: if time after operation passed
}





RFID: RFID device on spi bus

RFID-->RFID_module: Interrupt from RFID
RFID_module --> RFID: Read value from device
RFID_module --> Stream: Callback with read value
 









@enduml